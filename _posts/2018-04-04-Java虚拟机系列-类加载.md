---
layout: post
title: "「Java虚拟机系列」二、Java虚拟机之类加载"
subtitle: 'Java虚拟机原理学习'
date:       2018-04-04
author: "Wangxiong"
header-style: text
tags:
  - Java
  - JVM
---

Java虚拟机之类加载

## 1.对象的创建过程

Person person = new Person();
1、因为new用到了Person.class，所以要先找到Person.class文件，并加载到内存中，放在运行时数据区的方法区内。
2、执行该类中的static代码块，如果有的话给Person类进行初始化
3、在堆内存中开辟空间分配内存地址，区创建一个这个类的java.lang.Class对象，用来封装类在方法区类的对象
4、在堆内存中建立对象的特有属性，并进行默认初始化
5、对属性进行显示初始化
6、对对象进行构造代码块初始化
7、对对象进行与对应构造函数初始化
8、将内存地址赋值给栈内存的person变量

## 2.JVM将类加载

分为三个步骤：装载（load）、链接（Link）、初始化（Initialize）
链接又分为三个步骤：验证、准备、解析
1）装载：查找并加载类的二进制数据
2）链接：
验证：确保被加载类的正确性
准备：为类的静态变量分配内存，并将其初始化为默认值
解析：把类中的符号引用解析为直接引用
3）初始化：为类的静态变量赋正确的初始值

## 3.类什么时候初始化

1、创建类的实例，也就是new一个对象
2、调用某个类或者接口的静态变量、或者对该静态变量赋值
3、调用类的静态方法
4、反射
5、初始化一个类的子类（后首先初始化子类的父类）
6、JVM启动表明的启动类，即文件名和类名相同的那个类

## 4.加载类的方式

1）从本地系统直接加载
2）通过网络下载class文件
3）从zip，jar等归档文件中加载.class文件
4）从专有数据库中提取class文件
5）将Java源文件动态编译为.class文件